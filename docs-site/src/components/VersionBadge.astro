---
// Read version from Cargo.toml at build time
import { readFileSync } from 'fs';
import { resolve } from 'path';

let version = 'unknown';
try {
  const cargoToml = readFileSync(resolve('../Cargo.toml'), 'utf-8');
  // Match version in [workspace.package] section or at root level
  const versionMatch = cargoToml.match(/\[workspace\.package\][^\[]*version\s*=\s*"([^"]+)"/s)
    || cargoToml.match(/^version\s*=\s*"([^"]+)"/m);
  if (versionMatch) {
    version = versionMatch[1];
  }
} catch (error) {
  console.error('Failed to read version from Cargo.toml:', error);
}
---

<div class="version-badge">
  <span class="version-label">v{version}</span>
</div>

<style>
  .version-badge {
    display: inline-flex;
    align-items: center;
    margin-left: 0.75rem;
  }

  .version-label {
    font-size: 0.8125rem;
    font-weight: 600;
    padding: 0.25rem 0.625rem;
    background: var(--sl-color-gray-6);
    color: var(--sl-color-white);
    border-radius: 0.375rem;
    border: 1px solid var(--sl-color-gray-5);
    white-space: nowrap;
  }

  /* Better contrast in light mode */
  :root[data-theme='light'] .version-label {
    background: var(--sl-color-gray-5);
    color: var(--sl-color-white);
    border-color: var(--sl-color-gray-4);
  }

  @media (max-width: 50rem) {
    .version-badge {
      margin-left: 0.5rem;
    }

    .version-label {
      font-size: 0.75rem;
      padding: 0.1875rem 0.5rem;
    }
  }
</style>
